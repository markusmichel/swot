{# Shows all messages between the current user and one of his friends. #}

{% extends "::base.html.twig" %}
{% set partner_username = partner.username %}

{% block title %}
    {% trans with {'%username%': partner.username}%}conversation.page_title %username%{% endtrans %}
{% endblock %}

{% block body %}
    <h1>
        {% trans with {'%username%': partner.username} %}conversation.page_title %username%{% endtrans %}
    </h1>

    <br/>

    <form action="{{ path('conversation', {id: conversation.id}) }}" method="post" {{ form_enctype(messageForm) }}>
        {{ form_widget(messageForm) }}

        <button type="submit">send</button>
    </form>

    {% for message in messages %}
        <div>
            sender:
            {# only link partner, not the user himself #}
            {% if message.from == partner %}
                <a href="{{ path('friend_show', {id: partner.id}) }}">
                    {{ message.from.username }}
                </a>
            {% else %}
                you
            {% endif %}
        </div>
        <div>id: {{ message.id }}</div>
        <div>conversation id: {{ message.conversation.id }}</div>
        <div>date: {{ message.sent|date }}</div>
        <div>{{ message.text }}</div>

        {{ form(deleteForms[message.id]) }}
        
        <hr/>
    {% endfor %}

{% endblock %}
