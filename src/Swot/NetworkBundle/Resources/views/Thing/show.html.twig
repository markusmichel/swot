{% extends "::base.html.twig" %}

{% block title %}SwotNetworkBundle:Frontend:newsfeed{% endblock %}

{% block headline %}
    <div class="profile-picture-container flex-row">
        <h1 class="profile-picture-title">
            {{ thing.name }}
        </h1>
        <div class="small-hex flex-left">
            <img class="maskborder" src="
                    {{ (profile_image_folder ~ thing.profileImage) | imagine_filter('profile_image_thumb')|default('http://localhost/swot/web/res/gfx/thing-inverted.jpg') }}"
                    />
        </div>
        <div class="long-hex flex-center"></div>
        <div class="long-hex-after flex-right"></div>
    </div>
    <div class="thing-detail meta-info">
        <div>{% trans %}common.registered_since{% endtrans %}: {{ thing.ownerSince.date }}</div>
        <div>{% trans %}thing.owner_since{% endtrans %}: {{ thing.ownership.since.date }}</div>
    </div>
{% endblock %}

{% block body %}
    <div class="hex-list small cssmasks">
        <a class="inline small-hex" href="{{ path('friend_show', {id: thing.ownership.owner.id}) }}">
                <div class="hex-item"><div class="hex-item-inner">Owner: <br />{{ thing.ownership.owner.username }}</div></div>
                <img class="maskborder opac" src="
                    {{ (profile_image_folder ~ thing.ownership.owner.profileImage) | imagine_filter('profile_image_thumb')|default('http://localhost/swot/web/res/gfx/person-inverted.jpg') }}"
                />
        </a>
        <div class="small-hex inline">
            <div class="hex-item"><div class="hex-item-inner">Category: <br />{{ status.device.classification }}</div></div>
            <img class="maskborder opac" src="http://localhost/swot/web/res/gfx/help.png"/>
        </div>
        <div class="small-hex inline">
            <div class="hex-item"><div class="hex-item-inner">Access: <br />{{ thing.accessType }}</div></div>
            <img class="maskborder opac" src="http://localhost/swot/web/res/gfx/security.png"/>
        </div>
    </div>
    {{ dump(thing) }}

    <ul>
        {% for function in thing.functions %}
            {% set functionForm = functionForms[function.id] %}
            <li>
                {#<form action="{{ path('thing_activate_function', {id: thing.id, functionId: function.id}) }}" method="post" novalidate="novalidate" name="{{ function.id }}">#}
                <form action="{{ path('thing_show', {id: thing.id}) }}" method="post" novalidate="novalidate" name="{{ function.id }}">
                    {{ form_widget(functionForm.createView()) }}

                    <input type="hidden" name="_fid" value="{{ function.id }}"/>

                    <button type="submit">activate</button>
                </form>
            </li>
        {% endfor %}
    </ul>

    {% if is_granted('admin', thing) %}
        {{ form(delete_form) }}

        <a href="{{ path('thing_settings', {id: thing.id}) }}" class="button primary">Settings</a>
        <a href="{{ path('thing_lend', {id: thing.id}) }}" class="button primary">Lend</a>
    {% endif %}

    {% for message in messages %}
        {{ message.sent|date }} <br/>
        {{ message.message }}
        <hr/>
    {% endfor %}

{% endblock %}